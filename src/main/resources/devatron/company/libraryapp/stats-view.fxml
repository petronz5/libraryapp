<?xml version="1.0" encoding="UTF-8"?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.chart.BarChart?>
<?import javafx.scene.chart.CategoryAxis?>
<?import javafx.scene.chart.LineChart?>
<?import javafx.scene.chart.NumberAxis?>
<?import javafx.scene.chart.PieChart?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.Tab?>
<?import javafx.scene.control.TabPane?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.VBox?>

<BorderPane xmlns:fx="http://javafx.com/fxml"
            fx:controller="devatron.company.libraryapp.StatisticsController"
            stylesheets="@styles.css">

  <top>
    <HBox spacing="10" style="-fx-background-color: #34495e;">
      <padding>
        <Insets top="10" right="10" bottom="10" left="10"/>
      </padding>
      <Label fx:id="lblStatsTitle"
             text="Statistiche Libreria"
             style="-fx-font-size: 20px; -fx-font-weight: bold; -fx-text-fill: white;"/>
      <TextField fx:id="txtSearchBook"
                 promptText="Cerca libro per titolo o ISBN"
                 style="-fx-background-radius: 4; -fx-font-size: 14px;"/>
      <Button fx:id="btnBack"
              text="Torna al menù"
              onAction="#handleBack"
              style="-fx-background-color: #2980b9; -fx-text-fill: white; -fx-font-weight: bold;"/>
    </HBox>
  </top>

  <center>
    <TabPane prefWidth="900" prefHeight="650">

      <!-- TAB 1: Per genere -->
      <tabs>
        <Tab text="Per genere">
          <VBox alignment="CENTER" spacing="20">
            <PieChart fx:id="pieChart"
                      prefWidth="400" prefHeight="400"
                      styleClass="stats-pie"/>
            <TableView fx:id="tableSoldBooks" prefHeight="200" styleClass="stats-table">
              <columns>
                <TableColumn fx:id="colIsbn"  text="ISBN"  prefWidth="120"/>
                <TableColumn fx:id="colTitle" text="Titolo" prefWidth="200"/>
                <TableColumn fx:id="colSold"  text="Venduti" prefWidth="100"/>
              </columns>
            </TableView>
          </VBox>
        </Tab>

        <!-- TAB 2: Vendite mensili -->
        <Tab text="Vendite mensili">
          <VBox spacing="10">
            <padding>
              <Insets top="10" right="10" bottom="10" left="10"/>
            </padding>
            <Label text="Vendite per mese" style="-fx-font-size:16px; -fx-font-weight:bold;"/>

            <LineChart fx:id="chartQty" prefHeight="250" prefWidth="700">
              <xAxis>
                <CategoryAxis fx:id="xAxisQty" label="Mese"/>
              </xAxis>
              <yAxis>
                <NumberAxis fx:id="yAxisQty" label="Quantità"/>
              </yAxis>
            </LineChart>

            <LineChart fx:id="chartRevenue" prefHeight="250" prefWidth="700">
              <xAxis>
                <CategoryAxis fx:id="xAxisRev" label="Mese"/>
              </xAxis>
              <yAxis>
                <NumberAxis fx:id="yAxisRev" label="Ricavi (€)"/>
              </yAxis>
            </LineChart>

            <TableView fx:id="tableMonth" prefHeight="200" styleClass="stats-table">
              <columns>
                <TableColumn fx:id="colMonth" text="Mese"       prefWidth="120"/>
                <TableColumn fx:id="colMQty"  text="Quantità"   prefWidth="100"/>
                <TableColumn fx:id="colRev"   text="Ricavi (€)" prefWidth="120"/>
              </columns>
            </TableView>
          </VBox>
        </Tab>

        <!-- TAB 3: Bestseller anno corrente -->
        <Tab text="Bestseller anno">
          <VBox spacing="20" alignment="CENTER">
            <BarChart fx:id="barChartBestseller" prefWidth="800" prefHeight="500">
              <xAxis>
                <CategoryAxis fx:id="bestsellerXAxis" label="Titolo"/>
              </xAxis>
              <yAxis>
                <NumberAxis fx:id="bestsellerYAxis" label="Venduti"/>
              </yAxis>
            </BarChart>
          </VBox>
        </Tab>

        <!-- TAB 4: Ricavi per genere -->
        <Tab text="Ricavi per genere">
          <VBox alignment="CENTER" spacing="20">
            <PieChart fx:id="pieChartRevenue"
                      prefWidth="400" prefHeight="400"
                      styleClass="stats-pie"/>
          </VBox>
        </Tab>
      </tabs>
    </TabPane>
  </center>
</BorderPane>
